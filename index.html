<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Alcohol → Grams of Ethanol & Risk (Japan Study)</title>
  <style>
    :root { --bg:#0b0f14; --card:#121822; --text:#e8eef7; --muted:#9fb2c8; --accent:#6ee7ff; }
    *{box-sizing:border-box}
    body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,Helvetica,Arial,sans-serif;background:var(--bg);color:var(--text);margin:0;display:grid;place-items:center;min-height:100vh;padding:24px}
    .card{background:var(--card);border:1px solid #1f2a38;border-radius:16px;max-width:760px;width:100%;padding:20px;box-shadow:0 10px 30px rgba(0,0,0,.25)}
    h1{font-size:1.25rem;margin:0 0 12px}
    p.hint{color:var(--muted);margin-top:0}
    .grid{display:grid;grid-template-columns:1fr 1fr;gap:12px}
    label{font-size:.9rem;color:var(--muted)}
    input[type="number"]{width:100%;padding:10px;border-radius:10px;border:1px solid #253243;background:#0e141d;color:var(--text)}
    input[type="checkbox"]{transform:translateY(1px)}
    .row{display:flex;gap:10px;align-items:center;flex-wrap:wrap}
    .divider{height:1px;background:#1f2a38;margin:14px 0}
    .btn{appearance:none;background:#1a2533;color:var(--text);border:1px solid #2a3a50;border-radius:10px;padding:10px 14px;cursor:pointer}
    .btn.primary{background:linear-gradient(90deg,#1ddde2,#5cc4ff);color:#00222b;border:0;font-weight:700}
    .result{font-size:1.1rem;margin-top:10px}
    .muted{color:var(--muted)}
    .right{justify-content:flex-end}
    .small{font-size:.85rem}
    a{color:var(--accent);text-decoration:none}
    a:hover{text-decoration:underline}
    .pill{display:inline-block;padding:2px 8px;border-radius:999px;background:#0e141d;border:1px solid #253243;font-size:.8rem;color:var(--muted)}
  .alert{border:1px solid #3b2a2a;background:#201416;color:#ffd9d9;border-radius:12px;padding:10px}.alert strong{color:#ffb3b3}
  </style>
</head>
<body>
  <main class="card" role="main">
    <h1>Alcohol → Grams of Ethanol & Modeled Risk</h1>
    <p class="hint">Compute grams of ethanol and a simple, dose-based cancer risk estimate using the Japan case–control study (10 drink-years ≈ 5% higher odds of all cancers). See <a href="https://pubmed.ncbi.nlm.nih.gov/31814116/" rel="noopener" target="_blank">PubMed: 31814116</a>.</p>

    <form id="calc" onsubmit="event.preventDefault(); compute();">
      <div class="grid">
        <div>
          <label for="vol">Volume (mL)</label>
          <input id="vol" type="number" inputmode="decimal" min="0" step="0.1" placeholder="e.g., 40" required />
        </div>
        <div>
          <label for="abv">ABV (%)</label>
          <input id="abv" type="number" inputmode="decimal" min="0" max="100" step="0.1" placeholder="e.g., 13.5" required />
        </div>
      </div>

      <div class="divider"></div>

      <div class="grid">
        <div>
          <label for="rho">Ethanol density (g/mL)</label>
          <div class="row">
            <input id="rho" type="number" inputmode="decimal" min="0" step="0.001" value="0.789" disabled aria-describedby="rhoHelp" />
            <label class="small"><input id="editRho" type="checkbox" /> allow edit</label>
          </div>
          <div id="rhoHelp" class="small muted">Default 0.789 g/mL at ~20 °C.</div>
        </div>
        <div>
          <label for="years">Exposure duration (years)</label>
          <div class="row">
            <input id="years" type="number" min="0.0027" step="0.000001" value="60" />
            <span class="pill" title="Japan study heuristic">10 drink-years ≈ 5%</span>
          </div>
        </div>
      </div>

      <div class="grid">
        <div>
          <label>Pattern</label>
          <div class="row small" role="radiogroup" aria-label="pattern">
            <label><input type="radio" name="pattern" value="daily" checked> daily</label>
            <label><input type="radio" name="pattern" value="once"> one time</label>
          </div>
          <div class="small muted">• <b>daily</b>: this serving every day for the selected years.<br>• <b>one time</b>: a single serving across the chosen span (e.g., years = 0.0027397 ≈ 1 day). Drink‑years then equal drinks ÷ 365.</div>
        </div>
      </div>

      <div class="divider"></div>

      <div class="result" aria-live="polite">
        <div><strong>Grams of ethanol per serving:</strong> <span id="grams">—</span></div>
        <div class="small muted">Formula: grams = volume × (ABV/100) × density</div>
      </div>

      <div class="result" aria-live="polite" style="margin-top:8px;">
        <div><strong>Average drinks/day (Japan unit, 23 g):</strong> <span id="drinksPerDay">—</span></div>
        <div><strong>Drink-years (drinks/day × years):</strong> <span id="drinkYears">—</span></div>
        <div><strong>Modeled ↑ odds of all cancers:</strong> <span id="risk">—</span> <span class="small muted">(linear scaling: 10 drink-years ≈ 5%)</span></div>
      </div>

      <div id="cypBox" class="alert small" style="margin-top:8px;" role="status" aria-live="polite">
        <strong>CYP2E1 note:</strong> Single‑sitting intakes around <strong>≥10–15 g ethanol</strong> can increase CYP2E1 activity, raising oxidative stress. <span id="cypNow"></span>
      </div>

      <p class="small muted">
        This is a simple dose-exposure model from a Japanese case–control study; it does not adjust for genetics (e.g., ALDH2), site-specific risks, or other factors. Source: <a href="https://pubmed.ncbi.nlm.nih.gov/31814116/" target="_blank" rel="noopener">Light to moderate amount of lifetime alcohol consumption and cancer risk in Japan</a>.
      </p>
    </form>
  </main>

  <script>
    const vol = document.getElementById('vol');
    const abv = document.getElementById('abv');
    const rho = document.getElementById('rho');
    const gramsOut = document.getElementById('grams');
    const editRho = document.getElementById('editRho');

    const drinksPerDayOut = document.getElementById('drinksPerDay');
    const drinkYearsOut = document.getElementById('drinkYears');
    const riskOut = document.getElementById('risk');

    const yearsEl = document.getElementById('years');

    function toNumber(el){
      const v = parseFloat(el.value);
      return Number.isFinite(v) ? v : NaN;
    }

    function gramsPerServing(){
      const V = toNumber(vol);
      const A = toNumber(abv);
      const R = toNumber(rho);
      if(!Number.isFinite(V) || !Number.isFinite(A) || !Number.isFinite(R)) return NaN;
      return V * (A/100) * R; // grams
    }

    function compute(){
      const g = gramsPerServing();
      const yrs = toNumber(yearsEl);
      const pattern = document.querySelector('input[name="pattern"]:checked')?.value || 'daily';

      if(!Number.isFinite(g)) { gramsOut.textContent = '—'; } else { gramsOut.textContent = g.toFixed(2) + ' g'; }

      // CYP2E1 informational note — always visible; show current serving grams
      const cypBox = document.getElementById('cypBox');
      const cypNow = document.getElementById('cypNow');
      if(Number.isFinite(g)){
        cypNow.textContent = `(current serving ≈ ${g.toFixed(2)} g)`;
      } else {
        cypNow.textContent = '';
      }

      if(Number.isFinite(g)){
        let drinksPerDay;
        if(pattern === 'daily'){
          drinksPerDay = g / 23; // one serving every day
        } else { // one-time exposure
          const y = Number.isFinite(yrs) && yrs > 0 ? yrs : 1;
          drinksPerDay = (g / 23) / (y * 365);
        }
        drinksPerDayOut.textContent = drinksPerDay.toFixed(6);

        if(Number.isFinite(yrs)){
          const drinkYears = drinksPerDay * yrs;
          drinkYearsOut.textContent = drinkYears.toFixed(4);
          const riskPct = (drinkYears / 10) * 5; // 10 drink-years ≈ 5%
          riskOut.textContent = isFinite(riskPct) ? riskPct.toFixed(2) + '% (~overall odds)' : '—';
        } else {
          drinkYearsOut.textContent = '—';
          riskOut.textContent = '—';
        }
      } else {
        drinksPerDayOut.textContent = '—';
        drinkYearsOut.textContent = '—';
        riskOut.textContent = '—';
      }
    }

    [vol, abv, rho, yearsEl, ...document.querySelectorAll('input[name="pattern"]') ].forEach(el => el.addEventListener('input', compute));

    editRho.addEventListener('change', () => {
      rho.disabled = !editRho.checked;
      rho.focus();
    });

    // Initial
    compute();
  </script>
</body>
</html>
